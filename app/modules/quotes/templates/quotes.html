<!-- modules/quotes/templates/quotes.html -->
<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Wyceny - Wood Power CRM</title>
    <link rel="icon" href="{{ url_for('static', filename='images/favicon.png') }}" type="image/png">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('quotes.static', filename='css/quotes.css') }}">
    <link rel="stylesheet" href="{{ url_for('baselinker.static', filename='css/baselinker.css') }}">
    <script id="prices-data" type="application/json">{{ prices_json|safe }}</script>
    <script id="multipliers-data" type="application/json">{{ multipliers_json|safe }}</script>
</head>
<body data-role="{{ user_role }}"
      data-multiplier="{{ user_multiplier }}"
      data-client-type="{{ user_client_type or '' }}"
      data-flexible-partner="{{ 'true' if is_flexible_partner else 'false' }}">
    <div class="app-container">
        {% include 'sidebar/sidebar.html' %}
        <main class="main-content">
            <div class="quotes-layout">
                <!-- Lewy panel filtr√≥w status√≥w -->
                <aside class="quotes-status-panel" id="quotes-status-panel">
                    <h3 class="title-with-underline-h4">Filtry</h3>
                    <h4>Status</h4>
                    <div id="status-filters-container"></div>
                    <hr style="margin: 16px 0;">
                    <div class="filters-section">
                        <div class="floating-label-input">
                            <input type="text" id="quote-number-filter" placeholder=" " />
                            <label for="quote-number-filter">Numer wyceny</label>
                        </div>

                        <div class="floating-label-input">
                            <input type="text" id="client-number-filter" placeholder=" " />
                            <label for="client-number-filter">Nazwa klienta</label>
                        </div>

                        <div class="floating-label-input">
                            <input type="text" id="client-name-filter" placeholder=" " />
                            <label for="client-name-filter">Imiƒô / nazwisko</label>
                        </div>

                        <!-- Data od-do -->
                        <div class="floating-label-input double-date">
                            <input type="date" id="date-from-filter" placeholder=" " />
                            <input type="date" id="date-to-filter" placeholder=" " />
                            <label for="date-from-filter" class="double-label">Data (od - do)</label>
                        </div>

                        <!-- Pracownik - ukryj dla partnera -->
                        {% if user_role != 'partner' %}
                        <div class="floating-label-input">
                            <select id="employee-filter" class="styled-select" required>
                                <option value="">Wszyscy</option>
                                <!-- Opcje wstrzykujemy z JS -->
                            </select>
                            <label for="user-filter" class="select-label static">Pracownik</label>
                        </div>

                        <!-- ≈πr√≥d≈Ço -->
                        <div class="floating-label-input">
                            <select id="source-filter" class="styled-select" required>
                                <option value="">Wszystkie</option>
                                <optgroup label="Allegro">
                                    <option value="woodpower">woodpower</option>
                                </optgroup>
                                <optgroup label="Sklep internetowy">
                                    <option value="PrestaShop">PrestaShop</option>
                                </optgroup>
                                <optgroup label="Pozosta≈Çe">
                                    <option value="Osobi≈õcie">Osobi≈õcie</option>
                                    <option value="Telefon">Telefon</option>
                                    <option value="E-mail">E-mail</option>
                                </optgroup>
                                <optgroup label="Ceneo">
                                    <option value="Ceneo">Ceneo</option>
                                </optgroup>
                                <optgroup label="OLX">
                                    <option value="OLX">OLX</option>
                                </optgroup>
                            </select>
                            <label for="source-filter" class="select-label static">≈πr√≥d≈Ço zapytania</label>
                        </div>
                        {% endif %}
                    </div>
                    <hr style="margin: 12px 0;">
                    <div class="filter-actions">
                        <button id="clear-filters" class="clear-filters-button hidden">Wyczy≈õƒá filtry</button>
                    </div>
                </aside>

                <!-- Prawa strona z nag≈Ç√≥wkiem, filtrami i tabelƒÖ -->
                <div class="quotes-main">
                    <!-- Tabela -->
                    <div class="quote-header-row">
                        <div>Numer wyceny</div>
                        <div>Data</div>
                        <div>Nazwa klienta</div>
                        <div>Imiƒô i nazwisko</div>
                        <div>Opiekun</div>
                        <div>≈πr√≥d≈Ço</div>
                        <div>Status</div>
                        <div>Akcje</div>
                    </div>
                    <div id="quotes-table-body"></div>
                    <!-- Paginacja -->
                </div>
            </div>
        </main>
    </div>
    {% include 'quotes/templates/download_quote_modal.html' %}
    {% include "quotes/templates/quote_details_modal.html" %}
    {% include 'quotes/templates/edit_variant_modal.html' %}
    {% include 'quotes/templates/edit_total_discount_modal.html' %}
    {% include 'baselinker/templates/order_modal.html' %}

    <!-- Modal edytora wyceny -->
    <!-- Import modu≈Çu Quote Editor -->
    <script src="{{ url_for('quotes.static', filename='js/quote_editor.js') }}"></script>

    <!-- HTML Modalu Edytora -->
    <div id="quote-editor-modal" class="quote-editor-modal-overlay" style="display: none;">
        <div class="quote-editor-modal-box">
            <!-- Header modalu -->
            <div class="quote-editor-modal-header">
                <div class="quote-editor-modal-main">
                    <h2 class="quote-editor-modal-title">Edycja wyceny</h2>
                    <div class="quote-editor-modal-info">
                        <span id="edit-quote-number">Wycena: -</span>
                        <span id="edit-client-name">Klient: -</span>
                    </div>
                </div>
                <button class="quote-editor-modal-close" id="close-quote-editor" type="button">&times;</button>
            </div>

            <!-- G≈Ç√≥wna zawarto≈õƒá - kopia z calculator -->
            <div class="quote-editor-content">
                <!-- Sekcja produktu (kopia z calculator.html) -->
                <div class="edit-quote-container">
                    <div class="edit-quote-forms">
                        <div class="edit-quote-form">
                            <!-- Dane produktu -->
                            <section class="edit-product-data">
                                <h2 class="title-with-underline-h2">Produkt</h2>
                                <div class="product-inputs">
                                    <!-- Grupa cenowa -->
                                    <div class="client-type">
                                        <label for="edit-clientType" class="input-txt">Grupa cenowa:</label>
                                        <select data-field="clientType" id="edit-clientType" class="input-window">
                                            <option value="" disabled selected>Wybierz grupƒô</option>
                                            <!-- Opcje sƒÖ ≈Çadowane dynamicznie z API /quotes/api/multipliers -->
                                        </select>
                                    </div>
                                    <!-- D≈Çugo≈õƒá -->
                                    <div class="lenght">
                                        <label for="edit-length" class="input-txt">D≈Çugo≈õƒá (cm):</label>
                                        <input type="number" step="0.1" min="4" max="450" data-field="length" id="edit-length" class="input-window">
                                    </div>
                                    <!-- Szeroko≈õƒá -->
                                    <div class="width">
                                        <label for="edit-width" class="input-txt">Szeroko≈õƒá (cm):</label>
                                        <input type="number" step="0.1" min="4" max="120" data-field="width" id="edit-width" class="input-window">
                                    </div>
                                    <!-- Grubo≈õƒá -->
                                    <div class="thickness">
                                        <label for="edit-thickness" class="input-txt">Grubo≈õƒá (cm):</label>
                                        <input type="number" step="0.1" min="0.5" data-field="thickness" id="edit-thickness" class="input-window">
                                    </div>
                                    <!-- Ilo≈õƒá -->
                                    <div class="quantity">
                                        <label for="edit-quantity" class="input-txt">Ilo≈õƒá:</label>
                                        <input type="number" step="1" data-field="quantity" id="edit-quantity" class="input-window">
                                    </div>
                                </div>
                            </section>

                            <!-- Kalkulacja - warianty -->
                            <section class="edit-calculations-main">
                                <div class="calculations">
                                    <h2 class="title-with-underline-h2">Kalkulacja</h2>
                                    <p class="input-txt" style="margin-bottom: 6px;">Wybierz wariant wybrany przez klienta:</p>

                                    <!-- Lista wariant√≥w (8 sztuk) z placeholderami brutto/netto -->
                                    <!-- Zaktualizowana sekcja wariant√≥w identyczna jak w calculator.html -->
                                    <div class="variants">
                                        <div class="variants-header">
                                            <span class="header-availability">Dostƒôpny</span>
                                            <span class="header-title">Wariant</span>
                                            <span class="header-unit-brutto">Cena brutto</span>
                                            <span class="header-unit-netto">Cena netto</span>
                                            <span class="header-total-brutto">Warto≈õƒá brutto</span>
                                            <span class="header-total-netto">Warto≈õƒá netto</span>
                                        </div>

                                        <div class="dab-lity-ab-option variant-option">
                                            <input type="checkbox" class="variant-availability-checkbox"
                                                   data-variant="dab-lity-ab" checked>
                                            <input type="radio" name="edit-variantOption" id="edit-dab-lity-ab" value="dab-lity-ab">
                                            <label for="edit-dab-lity-ab" class="option-title">DƒÖb lity A/B</label>
                                            <span class="unit-brutto">---.-- PLN</span>
                                            <span class="unit-netto">---.-- PLN</span>
                                            <span class="total-brutto">---.-- PLN</span>
                                            <span class="total-netto">---.-- PLN</span>
                                        </div>

                                        <div class="dab-lity-bb-option variant-option">
                                            <input type="checkbox" class="variant-availability-checkbox"
                                                   data-variant="dab-lity-bb" checked>
                                            <input type="radio" name="edit-variantOption" id="edit-dab-lity-bb" value="dab-lity-bb">
                                            <label for="edit-dab-lity-bb" class="option-title">DƒÖb lity B/B</label>
                                            <span class="unit-brutto">---.-- PLN</span>
                                            <span class="unit-netto">---.-- PLN</span>
                                            <span class="total-brutto">---.-- PLN</span>
                                            <span class="total-netto">---.-- PLN</span>
                                        </div>

                                        <div class="dab-micro-ab-option variant-option">
                                            <input type="checkbox" class="variant-availability-checkbox"
                                                   data-variant="dab-micro-ab" checked>
                                            <input type="radio" name="edit-variantOption" id="edit-dab-micro-ab" value="dab-micro-ab">
                                            <label for="edit-dab-micro-ab" class="option-title">DƒÖb mikrowczep A/B</label>
                                            <span class="unit-brutto">---.-- PLN</span>
                                            <span class="unit-netto">---.-- PLN</span>
                                            <span class="total-brutto">---.-- PLN</span>
                                            <span class="total-netto">---.-- PLN</span>
                                        </div>

                                        <div class="dab-micro-bb-option variant-option">
                                            <input type="checkbox" class="variant-availability-checkbox"
                                                   data-variant="dab-micro-bb" checked>
                                            <input type="radio" name="edit-variantOption" id="edit-dab-micro-bb" value="dab-micro-bb">
                                            <label for="edit-dab-micro-bb" class="option-title">DƒÖb mikrowczep B/B</label>
                                            <span class="unit-brutto">---.-- PLN</span>
                                            <span class="unit-netto">---.-- PLN</span>
                                            <span class="total-brutto">---.-- PLN</span>
                                            <span class="total-netto">---.-- PLN</span>
                                        </div>

                                        <div class="jes-lity-ab-option variant-option">
                                            <input type="checkbox" class="variant-availability-checkbox"
                                                   data-variant="jes-lity-ab" checked>
                                            <input type="radio" name="edit-variantOption" id="edit-jes-lity-ab" value="jes-lity-ab">
                                            <label for="edit-jes-lity-ab" class="option-title">Jesion lity A/B</label>
                                            <span class="unit-brutto">---.-- PLN</span>
                                            <span class="unit-netto">---.-- PLN</span>
                                            <span class="total-brutto">---.-- PLN</span>
                                            <span class="total-netto">---.-- PLN</span>
                                        </div>

                                        <div class="jes-micro-ab-option variant-option">
                                            <input type="checkbox" class="variant-availability-checkbox"
                                                   data-variant="jes-micro-ab" checked>
                                            <input type="radio" name="edit-variantOption" id="edit-jes-micro-ab" value="jes-micro-ab">
                                            <label for="edit-jes-micro-ab" class="option-title">Jesion mikrowczep A/B</label>
                                            <span class="unit-brutto">---.-- PLN</span>
                                            <span class="unit-netto">---.-- PLN</span>
                                            <span class="total-brutto">---.-- PLN</span>
                                            <span class="total-netto">---.-- PLN</span>
                                        </div>

                                        <div class="buk-lity-ab-option variant-option">
                                            <input type="checkbox" class="variant-availability-checkbox"
                                                   data-variant="buk-lity-ab" checked>
                                            <input type="radio" name="edit-variantOption" id="edit-buk-lity-ab" value="buk-lity-ab">
                                            <label for="edit-buk-lity-ab" class="option-title">Buk lity A/B</label>
                                            <span class="unit-brutto">---.-- PLN</span>
                                            <span class="unit-netto">---.-- PLN</span>
                                            <span class="total-brutto">---.-- PLN</span>
                                            <span class="total-netto">---.-- PLN</span>
                                        </div>

                                        <div class="buk-micro-ab-option variant-option">
                                            <input type="checkbox" class="variant-availability-checkbox"
                                                   data-variant="buk-micro-ab" checked>
                                            <input type="radio" name="edit-variantOption" id="edit-buk-micro-ab" value="buk-micro-ab">
                                            <label for="edit-buk-micro-ab" class="option-title">Buk mikrowczep A/B</label>
                                            <span class="unit-brutto">---.-- PLN</span>
                                            <span class="unit-netto">---.-- PLN</span>
                                            <span class="total-brutto">---.-- PLN</span>
                                            <span class="total-netto">---.-- PLN</span>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- Sekcja Wyko≈Ñczenie - uproszczona struktura zgodna z wymaganiami -->
                            <section class="finishing-section">
                                <h2 class="title-with-underline-h2">Wyko≈Ñczenie</h2>

                                <!-- Blok wyboru rodzaju wyko≈Ñczenia - tylko 3 g≈Ç√≥wne opcje -->
                                <div class="finishing-block">
                                    <p class="input-txt">Rodzaj wyko≈Ñczenia:</p>
                                    <div class="button-group" id="edit-finishing-type-group">
                                        <button type="button" class="finishing-btn active" data-finishing-type="Surowe">Surowe</button>
                                        <button type="button" class="finishing-btn" data-finishing-type="Lakierowanie">Lakierowanie</button>
                                        <button type="button" class="finishing-btn" data-finishing-type="Olejowanie">Olejowanie</button>
                                    </div>
                                </div>

                                <!-- Pokazuje siƒô tylko po klikniƒôciu w Lakierowane -->
                                <div class="finishing-block" id="edit-finishing-variant-wrapper" style="display: none;">
                                    <p class="input-txt">Stopie≈Ñ po≈Çysku:</p>
                                    <div class="button-group">
                                        <button type="button" class="finishing-btn" data-finishing-variant="Bezbarwne">Bezbarwne</button>
                                        <button type="button" class="finishing-btn" data-finishing-variant="Barwne">Barwne</button>
                                    </div>
                                </div>

                                <!-- Blok wyboru koloru - pokazuje siƒô tylko po wybraniu "Barwne" -->
                                <div class="finishing-block" id="edit-finishing-color-wrapper" style="display: none;">
                                    <p class="input-txt">Kolor:</p>
                                    <div class="color-group">
                                        <button class="color-btn" data-finishing-color="POPIEL 20-07">
                                            <img src="{{ url_for('calculator.static', filename='images/finishing_colors/popiel-20-07.jpg') }}" alt="POPIEL 20-07">
                                            <span>POPIEL 20-07</span>
                                        </button>
                                        <button class="color-btn" data-finishing-color="BE≈ª BN-125/09">
                                            <img src="{{ url_for('calculator.static', filename='images/finishing_colors/bez-bn-125-09.jpg') }}" alt="BE≈ª BN-125/09">
                                            <span>BE≈ª BN-125/09</span>
                                        </button>
                                        <button class="color-btn" data-finishing-color="BRUNAT 22-10">
                                            <img src="{{ url_for('calculator.static', filename='images/finishing_colors/brunat-22-10.jpg') }}" alt="BRUNAT 22-10">
                                            <span>BRUNAT 22-10</span>
                                        </button>
                                        <button class="color-btn" data-finishing-color="BRUNAT 22-05">
                                            <img src="{{ url_for('calculator.static', filename='images/finishing_colors/brunat-22-05.jpg') }}" alt="BRUNAT 22-05">
                                            <span>BRUNAT 22-05</span>
                                        </button>
                                        <button class="color-btn" data-finishing-color="BRUNAT 22-15">
                                            <img src="{{ url_for('calculator.static', filename='images/finishing_colors/brunat-22-15.jpg') }}" alt="BRUNAT 22-15">
                                            <span>BRUNAT 22-15</span>
                                        </button>
                                        <button class="color-btn" data-finishing-color="BRUNAT 22-23">
                                            <img src="{{ url_for('calculator.static', filename='images/finishing_colors/brunat-22-23.jpg') }}" alt="BRUNAT 22-23">
                                            <span>BRUNAT 22-23</span>
                                        </button>
                                        <button class="color-btn" data-finishing-color="ORZECH 22-74">
                                            <img src="{{ url_for('calculator.static', filename='images/finishing_colors/orzech-22-74.jpg') }}" alt="ORZECH 22-74">
                                            <span>ORZECH 22-74</span>
                                        </button>
                                        <button class="color-btn" data-finishing-color="BRƒÑZ 22-50">
                                            <img src="{{ url_for('calculator.static', filename='images/finishing_colors/braz-22-50.jpg') }}" alt="BRƒÑZ 22-50">
                                            <span>BRƒÑZ 22-50</span>
                                        </button>
                                        <button class="color-btn" data-finishing-color="ORZECH 22-66">
                                            <img src="{{ url_for('calculator.static', filename='images/finishing_colors/orzech-22-66.jpg') }}" alt="ORZECH 22-66">
                                            <span>ORZECH 22-66</span>
                                        </button>
                                    </div>
                                </div>

                                <!-- Koszt wyko≈Ñczenia aktywnego produktu -->
                                <div class="products-total-summary" id="edit-active-finishing-cost" style="display: none;">
                                    <div class="products-total-title">Koszt wyko≈Ñczenia tego produktu:</div>
                                    <div class="products-total-details">
                                        <span class="edit-active-finishing-brutto-display">0.00 PLN brutto</span>
                                        <span class="edit-active-finishing-netto-display">0.00 PLN netto</span>
                                    </div>
                                </div>
                            </section>

                        </div>
                    </div>

                    <!-- Sekcja podsumowania -->
                    <div class="edit-summary-section-container">
                        <!-- Produkty w wycenie -->
                        <section class="edit-products-summary-main">
                            <div class="products-summary-header">
                                <h2 class="title-with-underline-h2">Produkty w wycenie</h2>
                                <button type="button" class="add-product-btn" id="edit-add-product-btn">
                                    <span class="add-product-icon">+</span>
                                    <span class="add-product-text">Dodaj produkt</span>
                                </button>
                            </div>
                            <div class="products-summary-container" id="edit-products-summary-container">
                                <!-- Dynamicznie generowane karty produkt√≥w -->
                            </div>
                        </section>

                        <!-- Podsumowanie koszt√≥w -->
                        <!-- Podsumowanie koszt√≥w - POPRAWIONA STRUKTURA -->
                        <div class="edit-quote-summary">
                            <div class="cost-row">
                                <span class="input-txt-bold">Koszt surowych produkt√≥w:</span>
                                <div class="cost-values">
                                    <span class="edit-order-brutto">0.00 PLN</span>
                                    <span class="edit-order-netto">0.00 PLN netto</span>
                                </div>
                            </div>

                            <div class="cost-row" style="border-bottom: 1px solid #ED6B24">
                                <span class="input-txt-bold">Koszty wyko≈Ñczenia:</span>
                                <div class="cost-values">
                                    <span class="edit-finishing-brutto">0.00 PLN</span>
                                    <span class="edit-finishing-netto">0.00 PLN netto</span>
                                </div>
                            </div>

                            <div class="cost-row" style="margin-bottom: 30px;">
                                <span class="input-txt-bold">Koszty produkt√≥w:</span>
                                <div class="cost-values">
                                    <span class="edit-product-total-brutto">0.00 PLN</span>
                                    <span class="edit-product-total-netto">0.00 PLN netto</span>
                                </div>
                            </div>

                            <div class="cost-row">
                                <span class="input-txt-bold">Koszt wysy≈Çki:</span>
                                <div class="cost-values">
                                    <span class="edit-courier" id="edit-courier-name">-</span>
                                    <span class="edit-delivery-brutto">0.00 PLN</span>
                                    <span class="edit-delivery-netto">0.00 PLN netto</span>
                                </div>
                            </div>

                            <div class="cost-row cost-total">
                                <span class="input-txt-bold">Suma zam√≥wienia:</span>
                                <div class="cost-values">
                                    <span class="edit-final-brutto">0.00 PLN</span>
                                    <span class="edit-final-netto">0.00 PLN netto</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer z przyciskami akcji -->
            <div class="quote-editor-modal-footer">
                <button type="button" class="btn-calculate-shipping" id="edit-calculate-shipping-btn" title="Oblicz wycenƒô wysy≈Çki GlobKurier">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M0 3.5A1.5 1.5 0 0 1 1.5 2h9A1.5 1.5 0 0 1 12 3.5V5h1.02a1.5 1.5 0 0 1 1.17.563l1.481 1.85a1.5 1.5 0 0 1 .329.938V10.5a1.5 1.5 0 0 1-1.5 1.5H14a2 2 0 1 1-4 0H5a2 2 0 1 1-3.998-.085A1.5 1.5 0 0 1 0 10.5v-7zm1.294 7.456A1.999 1.999 0 0 1 4.732 11h5.536a2.01 2.01 0 0 1 .732-.732V3.5a.5.5 0 0 0-.5-.5h-9a.5.5 0 0 0-.5.5v7a.5.5 0 0 0 .294.456zM12 10a2 2 0 0 1 1.732 1h.768a.5.5 0 0 0 .5-.5V8.35a.5.5 0 0 0-.11-.312l-1.48-1.85A.5.5 0 0 0 13.02 6H12v4zm-9 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm9 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                    </svg>
                    Oblicz wysy≈Çkƒô
                </button>
                <div class="footer-right-buttons">
                    <button type="button" class="btn btn-secondary" id="cancel-quote-edit">Anuluj</button>
                    <button type="button" class="btn btn-primary" id="save-quote-changes">Zapisz zmiany</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal wyboru dostawy (skopiowany z calculator) -->
    <div id="deliveryModal" class="delivery-modal-overlay">
        <div class="delivery-modal-container">
            <!-- Header -->
            <div class="delivery-modal-header">
                <h2 class="delivery-modal-title">Wybierz spos√≥b dostawy</h2>
                <button type="button" class="delivery-modal-close" id="deliveryModalClose">
                    √ó
                </button>
            </div>

            <!-- Widok g≈Ç√≥wny - lista opcji -->
            <div id="deliveryMainView" class="delivery-modal-main-view">
                <!-- Przycisk dodania w≈Çasnego kuriera -->
                <button type="button" class="delivery-modal-add-custom" id="addCustomCarrier">
                    <span>‚ûï</span>
                    Dodaj w≈Çasnego kuriera
                </button>

                <!-- Nag≈Ç√≥wki kolumn -->
                <div class="delivery-modal-headers">
                    <div></div>
                    <div>Kurier</div>
                    <div id="deliveryHeaderAdjusted">Cena + 15%</div>
                    <div>Cena oryginalna</div>
                </div>

                <!-- Kontener opcji -->
                <div class="delivery-modal-options">
                    <!-- Lista opcji dostawy -->
                    <div class="delivery-modal-list" id="deliveryOptionsList">
                        <!-- Opcje generowane dynamicznie -->
                    </div>

                    <!-- Loading state -->
                    <div class="delivery-modal-loading delivery-modal-hidden" id="deliveryLoading">
                        <div class="delivery-modal-spinner"></div>
                        ≈Åadowanie opcji dostawy...
                    </div>

                    <!-- Empty state -->
                    <div class="delivery-modal-empty delivery-modal-hidden" id="deliveryEmpty">
                        <div class="delivery-modal-empty-icon">üì¶</div>
                        <div>Brak dostƒôpnych opcji dostawy</div>
                    </div>

                    <!-- Error state -->
                    <div class="delivery-modal-error delivery-modal-hidden" id="deliveryError">
                        <strong>B≈ÇƒÖd podczas ≈Çadowania opcji dostawy</strong>
                        <div id="deliveryErrorMessage"></div>
                    </div>
                </div>

                <!-- Paginacja -->
                <div class="delivery-modal-pagination delivery-modal-hidden" id="deliveryPagination">
                    <button type="button" class="delivery-modal-page-btn" id="deliveryPrevPage" disabled>
                        ‚Äπ
                    </button>
                    <div id="deliveryPageNumbers" class="delivery-modal-page-numbers">
                        <!-- Numery stron generowane dynamicznie -->
                    </div>
                    <button type="button" class="delivery-modal-page-btn" id="deliveryNextPage" disabled>
                        ‚Ä∫
                    </button>
                </div>

                <!-- Info o pakowaniu -->
                <div class="delivery-modal-packing-info delivery-modal-hidden" id="deliveryPackingInfo">
                    ‚ÑπÔ∏è Do cen wysy≈Çki zosta≈Ça doliczona kwota na pakowanie.
                </div>
            </div>

            <!-- Widok formularza w≈Çasnego kuriera -->
            <div id="deliveryCustomView" class="delivery-modal-custom-form">
                <!-- Header z przyciskiem powrotu -->
                <div style="margin-bottom: 24px;">
                    <button type="button" class="delivery-modal-back" id="backToDeliveryList">
                        ‚Üê Powr√≥t do listy kurier√≥w
                    </button>
                </div>

                <!-- Formularz -->
                <div class="delivery-modal-form-grid">
                    <div class="delivery-modal-form-group full-width">
                        <label class="delivery-modal-form-label">Nazwa kuriera</label>
                        <input type="text"
                               class="delivery-modal-form-input"
                               id="customCarrierName"
                               placeholder="Wpisz nazwƒô kuriera...">
                    </div>

                    <div class="delivery-modal-form-group">
                        <label class="delivery-modal-form-label">Kwota netto (PLN)</label>
                        <input type="number"
                               class="delivery-modal-form-input"
                               id="customCarrierNetto"
                               placeholder="0.00"
                               step="0.01"
                               min="0">
                    </div>

                    <div class="delivery-modal-form-group">
                        <label class="delivery-modal-form-label">Kwota brutto (PLN)</label>
                        <input type="number"
                               class="delivery-modal-form-input"
                               id="customCarrierBrutto"
                               placeholder="0.00"
                               step="0.01"
                               min="0">
                    </div>
                </div>

                <!-- Kalkulator mar≈ºy -->
                <div class="delivery-modal-calculator">
                    <div class="delivery-modal-calculator-title">
                        üßÆ Kalkulacja ko≈Ñcowej ceny
                    </div>

                    <div class="delivery-modal-calculation-row">
                        <div class="delivery-modal-calculation-label">Kwota brutto:</div>
                        <div class="delivery-modal-calculation-value" id="calcBaseBrutto">0.00 PLN</div>
                    </div>

                    <div class="delivery-modal-calculation-row">
                        <div class="delivery-modal-calculation-label">Koszty pakowania (+15%):</div>
                        <div class="delivery-modal-calculation-value" id="calcMargin">0.00 PLN</div>
                    </div>

                    <div class="delivery-modal-calculation-row delivery-modal-calculation-final">
                        <div class="delivery-modal-calculation-label">Ko≈Ñcowa cena:</div>
                        <div class="delivery-modal-calculation-value" id="calcFinalPrice">0.00 PLN</div>
                    </div>
                </div>
            </div>

            <!-- Footer z przyciskami -->
            <div class="delivery-modal-footer">
                <button type="button" class="delivery-modal-btn delivery-modal-btn-secondary" id="deliveryModalCancel">
                    Anuluj
                </button>
                <button type="button" class="delivery-modal-btn delivery-modal-btn-primary" id="deliveryModalConfirm" disabled>
                    <span id="deliveryConfirmText">Zapisz</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Przeka≈º rolƒô u≈ºytkownika do JavaScript
        window.userRole = "{{ user_role }}";
        console.log('[UserRole] Rola u≈ºytkownika:', window.userRole);
    </script>

    <script src="{{ url_for('static', filename='js/sidebar.js') }}"></script>
    <script src="{{ url_for('calculator.static', filename='js/calculator.js') }}"></script>
    <script src="{{ url_for('quotes.static', filename='js/quotes.js') }}"></script>
    <script src="{{ url_for('baselinker.static', filename='js/baselinker.js') }}"></script>
</body>
</html>
